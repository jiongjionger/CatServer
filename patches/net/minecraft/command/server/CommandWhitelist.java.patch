--- ../src-base/minecraft/net/minecraft/command/server/CommandWhitelist.java
+++ ../src-work/minecraft/net/minecraft/command/server/CommandWhitelist.java
@@ -8,6 +8,7 @@
 import net.minecraft.command.CommandException;
 import net.minecraft.command.ICommandSender;
 import net.minecraft.command.WrongUsageException;
+import net.minecraft.entity.player.EntityPlayer;
 import net.minecraft.server.MinecraftServer;
 import net.minecraft.util.math.BlockPos;
 import net.minecraft.util.text.TextComponentString;
@@ -60,9 +61,14 @@
                 {
                     throw new WrongUsageException("commands.whitelist.add.usage", new Object[0]);
                 }
-
-                GameProfile gameprofile = server.getPlayerProfileCache().getGameProfileForUsername(args[1]);
-
+                // CatServer - start - offlineMode Support
+                GameProfile gameprofile;
+                if (server.isServerInOnlineMode()) {
+                    gameprofile = server.getPlayerProfileCache().getGameProfileForUsername(args[1]);
+                }else {
+                    gameprofile = new GameProfile(EntityPlayer.getOfflineUUID(args[1]), args[1]);
+                }
+                // CatServer - end
                 if (gameprofile == null)
                 {
                     throw new CommandException("commands.whitelist.add.failed", new Object[] {args[1]});
